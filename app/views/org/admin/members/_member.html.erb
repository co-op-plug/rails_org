<tr>
  <td>
    <p>
      <% if member.user && member.user.avatar.attached? %>
        <%= link_to admin_user_path(member.user_id) do %>
          <%= image_tag member.user.avatar.variant(resize_to_limit: [35, 35]), class: 'ui avatar image' %>
        <% end %>
      <% end %>
      <%= link_to member.name, admin_member_path(member) %>
    </p>
    <p class="ui grey text"><%= member.organ.name %></p>
  </td>
  <td class="error selectable">
    <table class="ui table">
    <% member.member_departments.each do |md| %>
      <tr>
        <td class="four wide">
          <% if md.department %>
          <%= link_to md.department.full_name, admin_department_path(md.department_id) %>
          <% end %>
        </td>
        <td class="three wide">
          <%= md.job_title&.name %>
        </td>
        <td class="two wide">
          <% if md.major %>
            <i class="crosshairs icon"></i>
          <% end %>
        </td>
        <td class="two wide">
          <%= link_to edit_admin_member_member_department_path(member, md), data: { tooltip: t('.edit') }, remote: true, class: 'ui mini circular icon button' do %>
            <i class="fas fa-pencil-alt"></i>
          <% end %>
          <%= link_to admin_member_member_department_path(member, md), method: :delete, data: { tooltip: t('.destroy') }, remote: true, class: 'ui mini circular icon button' do %>
            <i class="fas fa-trash-alt"></i>
          <% end %>
        </td>
      </tr>
    <% end %>
      <tr>
        <td colspan="5">
          <%= link_to new_admin_member_member_department_path(member), data: { tooltip: '添加职位' }, remote: true, class: 'ui mini circular icon button' do %>
            <i class="fas fa-plus"></i>
          <% end %>
        </td>
      </tr>
    </table>
  </td>
  <td><%= member.identity %></td>
  <td><%= member.join_on %></td>
  <td>
    <div class="ui labels">
      <% member.roles.pluck(:name).each do |role| %>
        <span class="ui label"><%= role %></span>
      <% end %>
      <%= link_to edit_who_roles_path('Member', member.id), data: { tooltip: t('role.who_roles.edit.title') }, remote: true do %>
        <i class="fas fa-user-shield"></i>
      <% end %>
    </div>
  </td>
  <td>
    <%= link_to profile_admin_member_path(member), data: { tooltip: t('.profile') }, class: 'ui mini circular icon button' do %>
      <i class="fas fa-id-card"></i>
    <% end %>
    <%= link_to admin_member_organ_grants_path(member), data: { tooltip: t('.role') }, class: 'ui mini circular icon button' do %>
      <i class="fas fa-user-shield"></i>
    <% end %>
    <%= link_to edit_admin_member_path(member), data: { tooltip: t('.edit') }, remote: true, class: 'ui mini circular icon button' do %>
      <i class="fas fa-pencil-alt"></i>
    <% end %>
    <%# link_to 'tutorials', admin_tutorials_path(member_id: member.id), class: 'ui mini circular button' %>
  </td>
</tr>

